#!/usr/sbin/nft -f

flush ruleset

table inet filter {
   chain input {
       type filter hook input priority 0;
       policy drop;
       
       # Chấp nhận tất cả các gói từ localhost
       iif lo accept
       
       # Accept established and related connections
       ct state established,related accept  

       # Chấp nhận gói từ cổng 22 (SSH)
       tcp dport 22 accept

       tcp dport 80 accept
       tcp dport 443 accept
       tcp dport 9869 accept

       tcp dport 7777 accept
       udp dport 7777 accept
   }

   chain forward {
       type filter hook forward priority 0;
   }

   chain output {
       type filter hook output priority 0;
   }
}
